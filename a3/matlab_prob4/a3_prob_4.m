clear

n = 8;

syms f1(x,y);
%f1(x,y)=sin(x)*cos(y);
f1(x,y)=x^(9/2)*y^(9/2);

[u1, A, g] = solve_2(n, f1, x, y);

reference_1 = full(compute_grid(n,f1,x,y));
max(max(abs(u1-reference_1)))

restart = 20;
maxit = 100;
tol = 10^(-9);
[x,flag,relres,iter] = gmres(A,g,restart,tol,maxit);


%O(h^6)
a = [ 1 1 1 1 1;...
     -1 0 1 2 3;...
      1 0 1 4 9;...
     -1 0 1 8 27;...
      1 0 1 16 81;...
     -1 0 1 32 243;...
     -1 0 1 64 729;...
    ];

b = [0 1 0 0 0 0 0]';

a\b

%O(h^5)
a = [ 1 1 1 1 1 1;...
     -1 0 1 2 3 4;...
      1 0 1 4 9 16;...
     -1 0 1 8 27 64;...
      1 0 1 16 81 256;...
     -1 0 1 32 243 1024;...
    ];

b = [0 1 0 0 0 0]';

u=a\b

%%%%

%O(h^5)
a = [ 1 1 1 1 1 1;...
     -1 0 1 2 3 4;...
      1 0 1 4 9 16;...
     -1 0 1 8 27 64;...
      1 0 1 16 81 256;...
     -1 0 1 32 243 1024;...
    ];

b = [0 1 0 0 0 0]';

u=a\b

%%%%

%O(h^4)
a = [ 1 1 1 1 1;... %0th
     -1 0 1 2 3;... %1st
      1 0 1 4 9;... %2nd
     -1 0 1 8 27;... %3rd
      1 0 1 16 81;... %4th
    ];

b = [0 1 0 0 0 ]';

u=a\b

u=[-1/4 -5/6 1.5 -1/2 -5/60]';


%O(h^3)
a = [ 1 1 1 1 1;...
     -1 0 1 2 3;...
      1 0 1 4 9;...
     -1 0 1 8 27;...
    ];

b = [0 1 0 0]';

u=a\b
u=[-1/2 1/6 0 1/2 -1/6]'


%O(h^2)
a = [ 1 1 1 1 1;...
     -1 0 1 2 3;...
      1 0 1 4 9;...
    ];

b = [0 1 0]';

u=a\b

% 
% % u_yy with O(h^4) accuracy
% a = [ 1  1 1 1 1 1 1;...
%      -3  2 -1 0 1 2 3;...
%       9  4  1 0 1 4 9;...
%      -27 8 -1 0 1 8 27;...
%     ];
% 
% b = [0 0 1 0]';
% 
% a\b

%o(h^4) accuracy (used for assignment)
%j=0
a = [ 1 1 1 1 1;... %0th
     -1 0 1 2 3;... %1st
      1/2 0 1/2 2 9/2;... %2nd
     -1/6 0 1/6 8/6 27/6;... %3rd
      1/24 0 1/24 16/24 81/24;... %4th
    ];

b = [0 1 0 0 0 ]';

u=a\b

u=[-1/4 -5/6 3/2 -1/2 5/60]';
%%%%%%%%%%%%%
%j=n
a = [    1   1    1     1     1;... %0th
         1   0   -1    -2    -3;... %1st
       1/2   0  1/2     2   9/2;... %2nd
       1/6   0 -1/6  -8/6 -27/6;... %3rd
      1/24   0 1/24 16/24 81/24;... %4th
    ];

b = [0 1 0 0 0 ]';
u2=a\b
u2=[1/4 5/6 -3/2 1/2 -5/60]';
